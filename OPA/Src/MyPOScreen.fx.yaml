MyPOScreen As screen:

    Image7_1 As image:
        Height: =1620
        Image: =gradient_color_blue_155118_1600x900
        ImagePosition: =ImagePosition.Fill
        Width: =2160
        ZIndex: =1

    Rectangle1_8 As rectangle:
        BorderColor: =RGBA(255, 255, 255, 1)
        BorderThickness: =2
        Fill: =RGBA(0, 0, 0, 1)
        Height: =156
        Width: =2160
        ZIndex: =2

    "GalleryList_2 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
        BorderColor: =RGBA(255, 255, 255, 1)
        BorderThickness: =2
        Fill: =RGBA(255, 255, 255, 0.15)
        Height: =1326
        Items: |-
            =Sort(Filter(RequestHeader, AcceptedBy=User().FullName, Contact="PO"),
            Switch(Status,
            "Submitted", 1, 
            "EnRoute", 2,
            "Approved", 3,
            "Rejected", 4,
            "Delivered", 5
            ))
        Layout: =Layout.Vertical
        OnSelect: =Set(galleryvisVar2, true)
        ShowScrollbar: =false
        TemplateFill: |
            = 
            RGBA(0,0,0,0)
        TemplatePadding: =0
        TemplateSize: =296
        Width: =1290
        X: =59
        Y: =242
        ZIndex: =3

        Image12_1 As image:
            Height: =171
            Image: |-
                =If(ThisItem.Status="Rejected", 'MicrosoftTeams-image (28)',
                If(ThisItem.Status="Approved", 'MicrosoftTeams-image (27)',
                Blank()
                ))
            OnSelect: =Select(Parent)
            Width: =383
            X: =652
            Y: =1
            ZIndex: =1

        Rectangle3_1 As rectangle:
            BorderColor: =RGBA(255, 255, 255, 1)
            BorderThickness: =2
            Fill: =RGBA(0, 13, 75, 1)
            Height: =296
            OnSelect: =Select(Parent)
            Visible: |-
                =If(ThisItem.UID=GalleryList_2.Selected.UID,
                true, 
                false
                )
            Width: =180
            X: =1110
            ZIndex: =2

        Title1_17 As label:
            Color: =RGBA(255, 255, 255, 1)
            Font: =Font.Verdana
            Height: =35
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: |-
                =ThisItem.Grower & ": " & ThisItem.Ranch
            VerticalAlign: =VerticalAlign.Top
            Width: =640
            X: =28
            Y: =18
            ZIndex: =3

        Separator1_4 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =1
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - 1
            ZIndex: =4

        Button1_10 As button:
            BorderColor: =Color.White
            Fill: =RGBA(0, 0, 0, 0)
            Font: =Font.Verdana
            Height: =114
            OnSelect: |-
                =If(
                    Or(
                        ThisItem.Status="Delivered", ThisItem.Status="Cancelled", ThisItem.Status="Rejected"), 
                        Notify("You cannot deliver an item that is cancelled, rejected, or already delivered", NotificationType.Error),
                Patch(RequestHeader, First(Filter(RequestHeader, UID=ThisItem.UID)), 
                {
                    Status: "EnRoute"
                }
                );
                
                Patch(HeaderMain, First(Filter(HeaderMain, ID=Value(ThisItem.UID))), 
                {
                    STATUS: "EnRoute"
                }
                );
                
                Refresh(HeaderMain);
                Refresh(RequestItemsList);
                Refresh(RequestHeader)
                    )
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Text: ="En Route"
            Width: =133
            X: =1133
            Y: =18
            ZIndex: =5

        Title1_25 As label:
            BorderColor: =RGBA(255, 255, 255, 1)
            BorderThickness: =1
            Color: =RGBA(255, 255, 255, 1)
            Font: =Font.Verdana
            Height: =62
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =15
            Text: |-
                =" Notes: " & ThisItem.Notes
            VerticalAlign: =VerticalAlign.Top
            Width: =497
            X: =28
            Y: =94
            ZIndex: =6

        Title1_22 As label:
            Color: |-
                =If(ThisItem.Status="Cancelled", Color.Red,
                If(ThisItem.Status="Approved", Color.Green,
                If(ThisItem.Status="Submitted", Color.White,
                If(ThisItem.Status="Rejected", Color.Red,
                If(ThisItem.Status="Delivered", Color.LightBlue,
                If(ThisItem.Status="EnRoute", Color.DeepPink,
                Color.White
                ))))))
            Font: =Font.Verdana
            Height: =38
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: =ThisItem.Status
            VerticalAlign: =VerticalAlign.Top
            Width: =525
            X: =142
            Y: =56
            ZIndex: =7

        Button1_13 As button:
            BorderColor: =Color.White
            DisplayMode: |-
                =If(
                    ThisItem.Status="EnRoute", DisplayMode.Edit, DisplayMode.Disabled)
            Fill: =RGBA(0, 0, 0, 0)
            Font: =Font.Verdana
            Height: =107
            OnSelect: |
                =Navigate(DeliveryScreen);
                Set(deliveridVar, ThisItem.UID)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Text: ="Deliver"
            Width: =133
            X: =1133
            Y: =171
            ZIndex: =8

        Title1_18 As label:
            Color: =Color.White
            Font: =Font.Verdana
            Height: =38
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: |-
                ="Status: " 
            VerticalAlign: =VerticalAlign.Top
            Width: =157
            X: =28
            Y: =56
            ZIndex: =9

        InputAddNotes_1 As text:
            Default: =""
            Font: =Font.Verdana
            Height: =107
            HintText: |-
                ="My Notes:"
            Mode: =TextMode.MultiLine
            OnSelect: =Select(Parent)
            Size: =16
            Width: =372
            X: =550
            Y: =171
            ZIndex: =10

        Button1_11 As button:
            BorderColor: =Color.White
            Fill: =RGBA(0, 0, 0, 0)
            Font: =Font.Verdana
            Height: =107
            OnSelect: |-
                =Patch(RequestHeader, First(Filter(RequestHeader, UID=ThisItem.UID)), {
                    Notes: ThisItem.Notes & ", " & User().FullName & ": " & InputAddNotes_1.Text
                }
                );
                
                Refresh(HeaderMain);
                Refresh(RequestItemsList);
                Refresh(RequestHeader)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Text: ="Add Notes"
            Width: =140
            X: =946
            Y: =172
            ZIndex: =11

        Button1_8 As button:
            BorderColor: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(118, 0, 0, 1)
            Font: =Font.Verdana
            FontWeight: =FontWeight.Normal
            Height: =114
            OnSelect: |-
                =If(
                    Or(
                        ThisItem.Status="Delivered", ThisItem.Status="Cancelled", ThisItem.Status="Rejected"), 
                        Notify("You cannot cancel an item that is cancelled, rejected, or already delivered", NotificationType.Error),
                Set(cancelVar, true)
                )
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =14
            Text: ="Cancel"
            Width: =140
            X: =946
            Y: =18
            ZIndex: =12

        Title1_29 As label:
            BorderColor: =RGBA(255, 255, 255, 1)
            BorderThickness: =1
            Color: =RGBA(255, 255, 255, 1)
            Font: =Font.Verdana
            Height: =107
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =15
            Text: |-
                =" Officer Notes: " & ThisItem.POnotes
            VerticalAlign: =VerticalAlign.Top
            Width: =497
            X: =28
            Y: =171
            ZIndex: =13

    "GalleryDetails_3 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
        BorderColor: =RGBA(255, 255, 255, 1)
        BorderThickness: =2
        Fill: =RGBA(255, 255, 255, 0.14)
        Height: =1326
        Items: =Filter(RequestItemsList, UID=GalleryList_2.Selected.UID)
        Layout: =Layout.Vertical
        ShowScrollbar: =false
        TemplateFill: |-
            =If(ThisItem.Status="Cancelled", Color.DarkRed,
            If(Value(ThisItem.NumberAttained) < Value(ThisItem.HowMany), RGBA(0,0,0,0),
            If(Value(ThisItem.NumberAttained) >= Value(ThisItem.HowMany), Color.DarkGreen,
            RGBA(0, 0, 0, 0)
            )))
        TemplatePadding: =0
        TemplateSize: =182
        Visible: =galleryvisVar2
        Width: =707
        X: =1393
        Y: =242
        ZIndex: =4

        Separator1_6 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =1
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - 1
            ZIndex: =5

        Title1_26 As label:
            Color: =RGBA(255, 255, 255, 1)
            Font: =Font.Verdana
            FontWeight: =FontWeight.Normal
            Height: =34
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: =If(spanVar=false, ThisItem.TypeOfMaterial, ThisItem.SpanishType)
            VerticalAlign: =VerticalAlign.Top
            Width: =244
            X: =165
            Y: =18
            ZIndex: =6

        Image2_3 As image:
            BorderColor: =RGBA(255, 255, 255, 1)
            BorderThickness: =2
            Height: =143
            Image: =First(Filter(RequestMaterials, Material=ThisItem.Material)).Thumbnail.Large
            OnSelect: =Select(Parent)
            Width: =130
            X: =21
            Y: =18
            ZIndex: =9

        Title1_27 As label:
            Color: =RGBA(255, 255, 255, 1)
            Font: =Font.Verdana
            FontWeight: =FontWeight.Normal
            Height: =59
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: =If(spanVar=false, ThisItem.Material, ThisItem.SpanishMaterial)
            VerticalAlign: =VerticalAlign.Top
            Width: =327
            X: =165
            Y: =52
            ZIndex: =10

        Title1_28 As label:
            Color: =RGBA(255, 255, 255, 1)
            Font: =Font.Verdana
            FontWeight: =FontWeight.Normal
            Height: =31
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: =ThisItem.NumberAttained & "/" & ThisItem.HowMany
            VerticalAlign: =VerticalAlign.Top
            Width: =112
            X: =165
            Y: =124
            ZIndex: =11

        InputNumber_2 As text:
            Align: =Align.Center
            Default: =ThisItem.HowMany
            Font: =Font.Verdana
            Format: =TextFormat.Number
            Height: =67
            HintText: |-
                ="#"
            OnSelect: =Select(Parent)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =25
            Width: =67
            X: =492
            Y: =18
            ZIndex: =12

        Button3_7 As button:
            BorderColor: =Color.White
            Fill: =RGBA(0, 0, 0, 0)
            Font: =Font.Verdana
            Height: =67
            OnSelect: |-
                =If(ThisItem.Status="Cancelled", Notify("This item has been cancelled", NotificationType.Error),
                Patch(
                    RequestItemsList, 
                    First(
                        Filter(
                         RequestItemsList, UID=ThisItem.UID, Material=ThisItem.Material)), {
                             NumberAttained: Value(InputNumber_2.Text)
                         }
                );
                
                Refresh(RequestItemsList);
                
                If(
                    Value(ThisItem.NumberAttained) >= Value(ThisItem.HowMany), 
                    Patch(
                        RequestItemsList, First(
                            Filter(
                                RequestItemsList, UID=ThisItem.UID, Material=ThisItem.Material)), {
                                    Status: "Completed"
                                }
                            )
                        );
                
                Refresh(RequestItemsList);
                Refresh(RequestHeader);
                Refresh(HeaderMain)
                
                )
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Text: =If(spanVar=false,"Confirm", "Confirmar")
            Width: =106
            X: =588
            Y: =18
            ZIndex: =13

        Button3_8 As button:
            BorderColor: =Color.White
            Fill: =RGBA(118, 0, 0, 1)
            Font: =Font.Verdana
            Height: =67
            OnSelect: |-
                =If(ThisItem.Status="Cancelled", Notify("This item has been cancelled", NotificationType.Error),
                Patch(
                    RequestItemsList, 
                    First(
                        Filter(
                         RequestItemsList, UID=ThisItem.UID, Material=ThisItem.Material)), {
                             Cancelled: true,
                             Status: "Cancelled"
                         }
                );
                
                Refresh(RequestItemsList);
                Refresh(RequestHeader);
                Refresh(HeaderMain)
                
                )
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Text: =If(spanVar=false,"Cancel", "Cancellar")
            Width: =106
            X: =588
            Y: =99
            ZIndex: =14

        InputNumber_3 As text:
            Align: =Align.Center
            Default: =
            Font: =Font.Verdana
            Format: =TextFormat.Number
            Height: =38
            HintText: |-
                ="#"
            OnSelect: =Select(Parent)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =25
            Width: =73
            X: =238
            Y: =124
            ZIndex: =15

        Button3_9 As button:
            BorderColor: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(0, 121, 187, 1)
            Font: =Font.Verdana
            Height: =38
            OnSelect: |-
                =If(ThisItem.Status="Cancelled", Notify("This item has been cancelled", NotificationType.Error),
                Patch(
                    RequestItemsList, 
                    First(
                        Filter(
                         RequestItemsList, UID=ThisItem.UID, Material=ThisItem.Material)), {
                             HowMany: Value(InputNumber_3.Text)
                         }
                );
                
                Refresh(RequestItemsList);
                
                If(
                    Value(ThisItem.NumberAttained) >= Value(ThisItem.HowMany), 
                    Patch(
                        RequestItemsList, First(
                            Filter(
                                RequestItemsList, UID=ThisItem.UID, Material=ThisItem.Material)), {
                                    Status: "Completed"
                                }
                            )
                        );
                
                Refresh(RequestItemsList);
                Refresh(RequestHeader);
                Refresh(HeaderMain)
                
                )
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Text: =If(spanVar=false,"Update", "Spanish")
            Width: =111
            X: =328
            Y: =124
            ZIndex: =16

    Image4_6 As image:
        Height: =156
        Image: ='reload-1.1s-200px (1)'
        OnSelect: |-
            =Refresh(HeaderMain);
            Refresh(RequestItemsList);
            Refresh(RequestHeader)
        Width: =142
        X: =1876
        ZIndex: =5

    Label1_31 As label:
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Verdana
        Height: =56
        Size: =25
        Text: |-
            ="My POs: " & CountRows(Filter(RequestHeader, Or(Status="Accepted", Status="Submitted"), AcceptedBy=User().FullName))
        Width: =520
        X: =59
        Y: =186
        ZIndex: =6

    Image4_7 As image:
        Height: =156
        Image: ='house-1.1s-200px (5)'
        OnSelect: |-
            =Refresh(HeaderMain);
            Refresh(RequestItemsList);
            Refresh(RequestHeader);
            Navigate(Main)
        Width: =142
        X: =2018
        ZIndex: =7

    Label1_34 As label:
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Verdana
        Height: =156
        Size: =45
        Text: ="Welcome, " & User().FullName
        Width: =1544
        X: =200
        ZIndex: =8

    Image8_3 As image:
        Height: =123
        Image: ='MicrosoftTeams-image (13)'
        Width: =119
        X: =57
        Y: =13
        ZIndex: =9

    Rectangle4_2 As rectangle:
        Fill: =RGBA(0, 0, 0, 1)
        Height: =1620
        Visible: =cancelVar
        Width: =2160
        ZIndex: =10

    Label6_2 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Verdana
        Height: =487
        Size: =55
        Text: ="Are you sure you want to cancel this request? This will permanently delete the request and cannot be undone"
        Visible: =cancelVar
        Width: =1913
        X: =155
        Y: =90
        ZIndex: =11

    Button7_6 As button:
        BorderColor: =Color.White
        Fill: =RGBA(184, 0, 0, 1)
        Font: =Font.Verdana
        Height: =983
        OnSelect: |-
            =Patch(RequestHeader, First(Filter(RequestHeader, UID=GalleryList_2.Selected.UID)), {
                Status: "Cancelled",
                Cancelled: true,
                CancelledBy: User().FullName
            }
            );
            
            Patch(HeaderMain, First(Filter(HeaderMain, UID=GalleryList_2.Selected.UID)), {
                STATUS: "Cancelled"
            }
            );
            
            Refresh(HeaderMain);
            Refresh(RequestItemsList);
            Refresh(RequestHeader);
            Set(cancelVar, false)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =40
        Text: ="Yes, cancel this request"
        Visible: =cancelVar
        Width: =409
        X: =1659
        Y: =598
        ZIndex: =12

    Button7_4 As button:
        BorderColor: =Color.White
        Fill: =RGBA(54, 176, 75, 1)
        Font: =Font.Verdana
        Height: =983
        OnSelect: =Set(cancelVar, false)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =75
        Text: ="No, take me back"
        Visible: =cancelVar
        Width: =1409
        X: =155
        Y: =598
        ZIndex: =13

    Rectangle4_3 As rectangle:
        Fill: =RGBA(0, 0, 0, 1)
        Height: =1620
        Visible: =returnVar
        Width: =2160
        ZIndex: =14

    Label6_3 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Verdana
        Height: =487
        Size: =55
        Text: ="Are you sure you want to return this request to the Pending Request Screen? This action cannot be undone"
        Visible: =returnVar
        Width: =1913
        X: =155
        Y: =90
        ZIndex: =15

    Button7_7 As button:
        BorderColor: =Color.White
        Fill: =RGBA(184, 0, 0, 1)
        Font: =Font.Verdana
        Height: =983
        OnSelect: |-
            =Patch(RequestHeader, First(Filter(RequestHeader, UID=GalleryList_2.Selected.UID)), {
                ReturnedBy: User().FullName,
                Returned: true,
                Status: "Submitted",
                AcceptedBy: Blank()
            }
            );
            
            Patch(HeaderMain, First(Filter(HeaderMain, UID=GalleryList_2.Selected.UID)), {
                STATUS: "Submitted"
            }
            );
            
            UpdateIf(RequestItemsList, UID=GalleryList_2.Selected.UID,
            {
                NumberAttained: 0
            }
            );
            
            Refresh(HeaderMain);
            Refresh(RequestItemsList);
            Refresh(RequestHeader);
            Set(returnVar, false)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =40
        Text: ="Yes, return this request"
        Visible: =returnVar
        Width: =409
        X: =1659
        Y: =598
        ZIndex: =16

    Button7_5 As button:
        BorderColor: =Color.White
        Fill: =RGBA(54, 176, 75, 1)
        Font: =Font.Verdana
        Height: =983
        OnSelect: =Set(returnVar, false)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =75
        Text: ="No, take me back"
        Visible: =returnVar
        Width: =1409
        X: =155
        Y: =598
        ZIndex: =17

    Button6_1 As button:
        BorderColor: =Color.White
        Fill: =RGBA(184, 0, 0, 1)
        Font: =Font.Verdana
        OnSelect: =Set(mapVar, false)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Text: ="Close Map"
        Visible: =mapVar
        X: =1981
        Y: =253
        ZIndex: =18

    Timer2 As timer:
        AutoStart: =true
        OnTimerEnd: |-
            =Refresh(HeaderMain);
            Refresh(RequestItemsList);
            Refresh(RequestHeader)
        Repeat: =true
        Visible: =false
        X: =346
        Y: =222
        ZIndex: =19

